# 项目概述
- 本项目是一个部门管理的项目，主要提供的功能
    - 部门清单
    - 查看部门详细信息
    - 新增部门
    - 修改部门
    - 删除部门
- 额外功能
    - 用户登录
        - 可选择十天内免登录
    - 退出登录
    - 在清单页面欢迎用户
    - 显示当前在线人数

# 实现概述
- 采用的技术是 sevlet + jsp + el表达式 + jstl标签库 + 过滤器 + 监听器

# 具体实现
- 欢迎页
    - 由 WelcomeServlet 实现
    - 主要操作
        - 校验当前会话是否登录
            - 若已登录，直接跳转至 部门展示
            - 若未登录，则查看本地是否有登录缓存（cookie）
                - 若有缓存，直接尝试使用缓存登录，即 将缓存中的用户名和密码存入请求域，然后将请求转发给 LoginServlet，执行其 doLogin()
                - 若没有缓存，则跳转到 index.jsp
- 登录界面
    - index.jsp 进行展示
    - 页面功能
        - 提供待填写用户和密码的表单
            - post 请求提交给 LoginServlet，执行其 doLogin()
        - 提供十天内免登录的 checkbox
            - 勾选后，提交的请求中会增加一个参数，LoginServlet 的 doLogin() 根据该参数来决定是否向浏览器发送 cookie
- 登录
    - LoginServlet 的 doLogin() 实现
    - 主要操作
        - 根据 请求提交的参数 或 请求域的参数 中的用户密码，在数据库中进行校验
            - 如果校验成功，则登录成功
                - 查看是否有 十天内免登录的参数
                    - 有的话向浏览器发送 有效期十天的 用户和密码的 cookie
                - 跳转到 部门展示
            - 如果校验失败，则登录失败
                - 跳转到 error.jsp 登录失败页面
- 部门展示
    - 部门信息获取功能
        - DeptServlet 的 doList() 实现
        - 主要操作
            - 在数据库中查找所有的部门信息，并将它们存入 list 中，将 list 存入 请求域
            - 将请求转发给 list.jsp
    - 清单页面
        - list.jsp 进行展示
        - 页面功能
            - 根据 部门信息获取功能 转发来的部门信息，展示所有部门的序号、部门编号、部门名称
            - 提供增加、删除、修改、详情按钮
                - 增加，跳转到 add.jsp
                - 删除，确认后 跳转到 DeptServlet，执行其 doDel()，跳转请求中包含当前部门的编号信息
                - 详情，跳转到 DeptServlet，执行其 doDetail()，跳转请求中包含当前部门的编号信息，并增加操作参数标记为 查看详情
                - 修改，跳转到 DeptServlet，执行其 doDetail()，跳转请求中包含当前部门的编号信息，并增加操作参数标记为 修改
            - 欢迎当前用户
                - 从 会话域 中获取当前 user 的名字
            - 提供 退出系统按钮，跳转到 LoginServlet，执行其 doExit()
            - 登录筛选功能（过滤器）
            - 显示当前在线人数（监听器）
                - 从 应用域 中获取 当前在线人数
- 增加部门页面
    - add.jsp 进行展示
    - 页面功能
        - 提供待填写新部门信息的表单
            - 提交后将会发送给 DeptServlet，执行其 doAdd()
- 增加部门
    - DeptServlet 的 doAdd() 实现
    - 主要操作
        - 根据 post 请求提交的参数，在数据库中添加 新的部门的数据
            - 如果添加成功，跳转到 部门展示
            - 如果添加失败，跳转到 false.jsp 操作失败页面
- 删除部门
    - DeptServlet 的 doDel() 实现
    - 主要操作
        - 根据请求中的部门编号，在数据库中删除相应的部门
            - 如果删除成功，跳转至 部门展示
            - 如果删除失败，跳转至 false.jsp 操作失败页面
- 详情
    - DeptServlet 的 doDetail() 实现
    - 主要操作
        - 根据请求中的部门编号，在数据库中取出相应部门的信息，存入 请求域
            - 操作参数为 查看详情，则将请求转发给 detail.jsp
            - 操作参数为 修改，则将请求转发给 edit.jsp
- 详情页面
    - detail.jsp 进行展示
        - 页面功能
            - 根据 详情 转发来的具体部门信息，展示该部门的部门编号、部门名称和部门位置
            - 提供后退按钮
- 修改页面
    - edit.jsp 进行展示
    - 页面功能
        - 提供待修改部门信息的表单
            - 该表单根据 详情 转发来的具体部门信息，自动填入该部门的部门编号、部门名称和部门位置，等待修改
            - 提交后将会发送给 DeptServlet，执行其 doModify()
- 修改
    - DeptServlet 的 doModify() 实现
    - 主要操作
        - 根据 post 请求提交的参数，在数据库中修改部门的信息
          - 如果修改成功，跳转到 部门展示
          - 如果修改失败，跳转到 false.jsp 操作失败页面
- 退出功能
    - LoginServlet 的 doExit() 实现
    - 主要功能
        - 判断当前会话是否过期，如果没有过期，
            - 则先清除 cookie 中的用户名和密码
            - 然后关闭当前 session
                - 会自动清除 Attribute 中的数据
                - 服务器会 立即创建一个新的 session
            - 最后跳转至登录界面
- 登录筛选功能
    - LoginCheckFilter 实现
    - 主要功能
        - 除了特定的几个页面外，访问其他页面需要验证当前会话是否已经登录
            - 若没有登录，则跳转至 toLogin.jsp 待登录页面
        - 特定页面，也就是非敏感页面
            - 欢迎相关
            - 登录相关
            - 出错相关
- 显示当前在线人数
    - bean 的 User类
        - 该类实现了 HttpSessionBindingListener
        - 当 user 被加入到 sesion 时，会对 应用域的 Attribute 中存储的 当前在线人数 + 1
        - 当 session 关闭时，会自动从 session 中将 user 移除，此时对 应用域的 Attribute 中存储的 当前在线人数 - 1
- 三个提示页面
    - error.jsp
        - 登录校验出错，登录失败后跳转的页面
        - 提供 重新登录 的链接
    - false.jsp
        - 进行增加、修改、删除操作失败时跳转的页面
        - 提供返回 部门展示 的链接
    - toLogin.jsp
        - 被过滤器过滤掉的请求，跳转的页面
        - 提供 去登录 的链接